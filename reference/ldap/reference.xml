<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.7 $ -->
 <reference id="ref.ldap">
  <title>LDAP</title>
  <titleabbrev>LDAP</titleabbrev>

  <partintro>
   <section id="ldap.intro">
    &reftitle.intro;
    <para>
     LDAP siginifie : Lightweight Directory Access Protocol 
     (Protocole léger d'accès aux annuaires). C'est un protocole
     utilisé pour accéder aux "serveurs de dossiers". Ces serveurs
     sont des bases de données particulières, qui stockent les informations
     sous forme d'arborescence.
    </para>
    <para> 
     Le concept d'arborescence est similaire à celui de la structure de votre
     système de fichier, hormis le fait que dans ce contexte, la racine
     s'appelle "le monde", et que le premier niveau de sous-dossier
     s'appelle "pays". Les niveaux encore en dessous sont des "compagnies"
     "organisation" ou "places", et encore plus bas, vous trouverez des
     "personnes" et même, des "équipements" et "documents".
    </para>
    <para>
     Pour identifier un fichier dans votre disque, vous utilisez un chemin tel
     que 
    </para>
    <literallayout>
    /usr/local/mon_application/documents
    </literallayout>
    <para>
     Le slash indique une division dans la référence, et la séquence est lue de
     gauche à droite.
    </para>
    <para> 
     l'équivalent d'une référence globale en LDAP s'appelle 
     un "nom distingué" ("distinguished name"), aussi appelé "dn". Un exemple de
     dn serait : 
    </para>
    <literallayout>
    cn=Jean Dupond,ou=Comptabilité,o=Ma Compagnie,c=FR
    </literallayout>
    <para>
     La virgule marque la séparation de chaque division comme référence, et la séquence est
     lue de droite à gauche. Il faut donc lire : 
    </para>
    <literallayout>
    country = FR
    organization = Ma Compagnie
    organizationalUnit = Comptabilité
    commonName = Jean Dupond
    </literallayout>
    <para>
     De la même façon qu'il n'y a pas de règle obligatoire sur 
     comment organiser les fichiers sur un disque dur, un 
     responsable de serveur de dossiers peut organiser le serveur
     comme cela lui semble le plus pratique. Cependant, il y a 
     des conventions à utiliser. Le principe est que vous ne pouvez
     pas écrire accéder à un serveur de dossier à moins que vous
     ne connaissiez sa structure, de même que vous ne pouvez
     une base de données sans en connaître les tables et les bases.
    </para>
    <para>
      Bien plus d'informations sont disponibles aux URL suivantes (en anglais) : 
     </para>

    <itemizedlist>
     <listitem>
      <para>
       <ulink url="&url.ldap.netscape;">Netscape</ulink>
      </para>
     </listitem>
<!--
     <listitem>
      <para>
       <ulink url="&url.ldap.michigan;">University of Michigan</ulink>
      </para>
     </listitem>

redirects to openldap.org

-->
     <listitem>
      <para>
       <ulink url="&url.ldap.openldap;">OpenLDAP Project</ulink>
      </para>
     </listitem>
     <listitem>
      <para>
       <ulink url="&url.ldap.ldapworld;">LDAP World</ulink>
      </para>
     </listitem>
    </itemizedlist>

     <para>    
      Le SDK Netscape contient un guide du programmeur
      (<ulink url="&url.ldap.netscape.sdk.docs;">Programmer's Guide</ulink>)
      très utile, au format HTML (et en anglais).
     </para>

   </section>

  <section id="ldap.requirements">
    &reftitle.required;
    <para>
     Vous devez télécharger et compiler les librairies clients
     LDAP, soit celles de University of Michigan 
     <ulink url="&url.ldap.mt;">ldap-3.3 package</ulink>,
     soit le <ulink url="&url.ldap.netscape.sdk;">Netscape Directory SDK 3.0</ulink>
     ou <ulink url="&url.ldap.openldap.source;">OpenLDAP</ulink>, 
     pour compiler le support LDAP.
    </para>
   </section>

   &reference.ldap.configure;

   &reference.ldap.ini;

   <section id="ldap.resources">
    &reftitle.resources;
    &no.resource;
   </section>

   &reference.ldap.constants;
   <section id="ldap.examples">
	&reftitle.examples;
     <para>
      Lit les informations sur toutes les entrées dont le nom
      commence par "S" sur le serveur de dossier, puis affiche
      le nom et l'adresse email.
     </para>

    <example>
     <title>Recherche avec LDAP</title>
     <programlisting role="php">
<![CDATA[
<?php
// La séquence de base avec LDAP est 
// connexion, liaison, recherche, interprétation du résultat
// déconnexion

echo "<h3>requête de test de LDAP</h3>";
echo "Connexion ...";
$ds=ldap_connect("localhost");  // doit être un serveur LDAP valide!
echo "Le résultat de connexion est ".$ds."<p>";

if ($ds) { 
    echo "Liaison ..."; 
    $r=ldap_bind($ds);     // this is an "anonymous" bind, typically
                           // read-only access
    echo "Le résultat de connexion est ".$r."<p>";

    echo "Recherchons (sn=S*) ...";
    // Recherche par nom
    $sr=ldap_search($ds,"o=My Company, c=US", "sn=S*");  
    echo "Le résultat de la recherche est ".$sr."<p>";

    echo "Le nombre d'entrées retournées est ".ldap_count_entries($ds,$sr)."<p>";

    echo "Lecture des entrées ...<p>";
    $info = ldap_get_entries($ds, $sr);
    echo "Données pour ".$info["count"]." entrées:<p>";

    for ($i=0; $i<$info["count"]; $i++) {
        echo "dn est : ". $info[$i]["dn"] ."<br>";
        echo "premiere entree cn : ". $info[$i]["cn"][0] ."<br>";
        echo "premier email : ". $info[$i]["mail"][0] ."<p>";
    }

    echo "Fermeture de la connexion";
    ldap_close($ds);

} else {
    echo "<h4>Impossible de se connecter au serveur LDAP.</h4>";
}
?>
]]>
    </programlisting>
   </example>
   </section>

   <section id="ldap.using">
    <title>Utiliser les fonctions LDAP de PHP</title>
     <para>
      Avant d'utiliser les fonctions LDAP, vous devez connaître
    <itemizedlist>
     <listitem>
      <para>
       Le nom ou l'adresse du serveur de dossiers que vous voudrez utiliser
      </para>
     </listitem>
     <listitem>
      <para>
       Le "base dn" du serveur (la partie du dossier monde
       qui est disponible sur ce serveur, ce qui peut être
       "o=Ma Compagnie,c=FR")
      </para>
     </listitem>
     <listitem>
      <para>
       Le mot de passe éventuel d'accès au serveur (de nombreux
       serveurs fournissent un accès anonyme en lecture, mais 
       requièrent des mots de passe pour tout le reste.
      </para>
     </listitem>
    </itemizedlist>
   </para>
   <para>
    La séquence LDAP typique que vous exécuterez sera la
    suivante : 
    <literallayout>
  ldap_connect()    // établit une connexion au serveur
     |
  ldap_bind()       // connexion anonyme ou identifiée
     |
  réalisation de commadnes comme des recherches ou des
  modifications, puis affichage du résultat.
     |
  ldap_close()      // déconnexion
     </literallayout>
    </para>
   </section>
  </partintro>
&reference.ldap.functions;
 </reference>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
