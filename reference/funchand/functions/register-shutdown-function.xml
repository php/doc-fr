<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.19 $ -->
<!-- EN-Revision: 1.18 Maintainer: yannick Status: ready -->
<!-- Reviewed: no -->

<refentry xml:id="function.register-shutdown-function" xmlns="http://docbook.org/ns/docbook">
 <refnamediv>
  <refname>register_shutdown_function</refname>
  <refpurpose>Enregistre une fonction pour exécution à l'extinction</refpurpose>
 </refnamediv>

 <refsect1 role="description">
  &reftitle.description;
  <methodsynopsis>
   <type>void</type><methodname>register_shutdown_function</methodname>
   <methodparam><type>callback</type><parameter>function</parameter></methodparam>
   <methodparam choice="opt"><type>mixed</type><parameter>parameter</parameter></methodparam>
   <methodparam choice="opt"><type>mixed</type><parameter>...</parameter></methodparam>
  </methodsynopsis>
  <simpara>
   Enregistre la fonction <parameter>function</parameter> pour exécution à l'extinction.
  </simpara>
  <para>
   Plusieurs appels à <function>register_shutdown_function</function> sont
   possibles dans le même script, et les fonctions seront appelées dans le
   même ordre que celui dans lequel elles sont enregistrées. Si vous appelez
   <function>exit</function> durant l'une des fonctions d'extinction,
   le processus sera définitivement arrêté, sans que les autres fonctions
   soient appelées.
  </para>
  <para>
   En PHP 4.0.6 et précédent sous Apache, les fonctions d'extinction 
   sont appelées après la fin de la requête
   (notamment les buffers ont été vidés), ce qui fait qu'il est impossible
   d'afficher du texte depuis cette fonction, avec <function>echo</function> ou
   <function>print</function>, ou encore de lire le contenu des buffers
   avec <function>ob_get_contents</function>.
   Depuis PHP 4.1, les fonctions d'extinction sont appelées comme une partie
   de la requête, donc, il est possible d'envoyer l'affichage depuis ces dernières.
   Il n'y a actuellement aucune façon de traiter les données avec les fonctions
   d'affichage du buffer dans la fonction d'extinction.
   La fonction d'extinction est appelé après avoir fermée tous les buffers de sortie ouverts,
   de ce fait, par exemple, la sortie ne sera pas compressée si <link
   linkend="ini.zlib.output-compression">zlib.output_compression</link> est
   activé.
  </para>
  <para>
   Depuis PHP 4, il est possible de passer des paramètres à la fonction d'extinction en
   passant des paramètres additionnels à la fonction
   <function>register_shutdown_function</function>.
  </para>
 </refsect1>

 <refsect1 role="parameters">
  &reftitle.parameters;
  <para>
   <variablelist>
    <varlistentry>
     <term><parameter>function</parameter></term>
     <listitem>
      <para>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>parameter</parameter></term>
     <listitem>
      <para>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>...</parameter></term>
     <listitem>
      <para>
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
 </refsect1>

 <refsect1 role="returnvalues">
  &reftitle.returnvalues;
  <para>
   &return.void;
  </para>
 </refsect1>

 <refsect1 role="examples">
  &reftitle.examples;
  <para>
   <example>
    <title>Exemple avec <function>register_shutdown_function</function></title>
    <programlisting role="php">
<![CDATA[
<?php
function shutdown()
{
        // Voici notre fonction shutdown
        // dans laquelle nous pouvons faire
        // toutes les dernières opérations
        // avant la fin du script.

        echo 'Script exécuté avec succès', PHP_EOL;
}

register_shutdown_function('shutdown');
?>
]]>
    </programlisting>
   </example>
  </para>
 </refsect1>

 <refsect1 role="notes">
  &reftitle.notes;
  <note>
   <para>
    Typiquement, les fonctions non définies causent des
    erreurs fatales en PHP, mais lorsque la fonction
    <parameter>function</parameter> est appelée avec
    <function>register_shutdown_function</function> en étant non définie,
    une erreur de type <constant>E_WARNING</constant> est générée. De plus,
    pour des raisons internes à PHP cette erreur va être indiquée
    comme <literal>Unknown at line #0</literal>.
   </para>
  </note>
  <note>
   <para>
    Le dossier de travail du script peut changer dans la fonction d'extinction
    sous quelques serveurs web, e.g. Apache.
   </para>
  </note>
  <note>
   <para>
    La fonction d'extinction est appelé durant l'arrêt du script, donc, les en-têtes
    sont toujours déjà envoyés.
   </para>
  </note>
 </refsect1>

 <refsect1 role="seealso">
  &reftitle.seealso;
  <para>
   <simplelist>
    <member><link linkend="ini.auto-append-file">auto_append_file</link></member>
    <member><function>exit</function></member>
    <member>La section sur la <link
    linkend="features.connection-handling">gestion des connexions</link></member>
   </simplelist>
  </para>
 </refsect1>

</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->