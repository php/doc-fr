<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 7c4dc1fde35b5d28bc17853f267caa51ae9dec80 Maintainer: yannick Status: ready -->
<!-- Reviewed: no -->

<section xml:id="mongo.installation" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 &reftitle.install;
 <para>
  Le driver MongoDB devrait fonctionner sur la plupart des systèmes : Windows, Mac OS X, 
  Unix, et Linux ; des petites machines aux gros serveurs ; sur des systèmes
  32 et 64 bit ; avec PHP 5.3 à 5.6 (les versions antérieures à la 1.6 
  supportent aussi PHP 5.2).
 </para>
 <para>
  &pecl.moved;
 </para>

 <simplelist>
  <member>
   <xref linkend="mongo.installation.manual" />
  </member>
  <member>
   <xref linkend="mongo.installation.nix" />
  </member>
  <member>
   <xref linkend="mongo.installation.windows" />
  </member>
  <member>
   <xref linkend="mongo.installation.osx" />
  </member>
  <member>
   <xref linkend="mongo.installation.gentoo" />
  </member>
  <member>
   <xref linkend="mongo.installation.fedora" />
  </member>
  <member>
   <xref linkend="mongo.installation.thirdparty" />
  </member>
 </simplelist>
 
 <section xml:id="mongo.installation.manual">
  <title>Installation manuelle</title>
  
  <para>
   Pour les développeurs des pilotes ou les personnes intéréssées par les derniers correctifs
   de bugs, vous pouvez compiler le pilote depuis
   <link xlink:href="&url.mongodb.github;">Github</link>.
   Allez sur Github et cliquez sur "download". Lancez ensuite :   
   <programlisting role="shell">
<![CDATA[
$ tar zxvf mongodb-mongodb-php-driver-<commit_id>.tar.gz
$ cd mongodb-mongodb-php-driver-<commit_id>
$ phpize
$ ./configure
$ make all
$ sudo make install
]]>
   </programlisting>
  </para>  
  <para>
   Effectuez ces changements à votre fichier php.ini:
  </para>
  <itemizedlist>
   <listitem>
    <para>
     Assurez-vous que la variable <emphasis>extension_dir</emphasis>
     pointe vers le dossier contenant le fichier <emphasis>mongo.so</emphasis>.
     La compilation devrait afficher l'endroit où PHP installe le driver ;
     l'affichage devrait ressembler à quelque chose comme :
     <programlisting role="txt">
<![CDATA[
Installing '/usr/lib/php/extensions/no-debug-non-zts-20060613/mongo.so'
]]>
     </programlisting>
     
     Vérifiez bien qu'il s'agisse du même dossier d'extensions que celui de votre PHP en lançant:
     
     <programlisting role="shell">
<![CDATA[
$ php -i | grep extension_dir
  extension_dir => /usr/lib/php/extensions/no-debug-non-zts-20060613 =>
                   /usr/lib/php/extensions/no-debug-non-zts-20060613
]]>
     </programlisting>
     
     Si ce n'est pas le cas, changez <emphasis>extension_dir</emphasis>
     de php.ini ou placez manuellement <emphasis>mongo.so</emphasis>.
    </para>
   </listitem>
   <listitem>
    <para>
     Pour chargez l'extension au démarrage de PHP, ajoutez cette ligne :
     
     <programlisting role="ini">
<![CDATA[
extension=mongo.so
]]>
     </programlisting>
     
    </para>
   </listitem>
  </itemizedlist>

 <section xml:id="mongo.installation.nix">
  <title>Installation sur les systèmes *NIX</title>

  <para>
   Exécutez :
   <programlisting role="shell">
<![CDATA[
$ sudo pecl install mongo
]]>
   </programlisting>
  </para>

  <para>
   Si vous utilisez CentOS ou Redhat, vous pouvez utiliser
   les <link xlink:href="&url.mongodb.rpm;">RPM</link>.
  </para>

  <para>
   Ajoutez la ligne suivante à votre fichier php.ini :
   <programlisting role="ini">
<![CDATA[
extension=mongo.so
]]>
   </programlisting>
  </para>

  <para>
   Si PECL fait un dépassement de mémoire lors de l'installation, assurez-vous
   que la directive memory_limit du fichier php.ini est fixée à au moins 128MB.
  </para>
 </section>
 
 <section xml:id="mongo.installation.windows">
  <title>Installation sous Windows</title>
  
  <para>
   Les binaires précompilés pour chaque version sont disponibles sur
   <link xlink:href="&url.pecl.package;mongo">PECL</link> pour une
   grande variété de combinaison de versions, de sécurité de threads, et de
   bibliothèques VC. Décompressez l'archive et placez php_mongo.dll dans votre
   dossier d'extension PHP ("ext" par défaut).
  </para>
  
  <para>
   Ajoutez la ligne suivante à votre fichier php.ini :
   <programlisting role="ini">
<![CDATA[
extension=php_mongo.dll
]]>
   </programlisting>
  </para>

  <note>
   <title>Dépendences DLL additionnelles pour les utilisateurs Windows</title>
   <para>
    &ext.windows.path.dll;
    <filename>libsasl.dll</filename>
   </para>
  </note>
 </section>
  
  <section xml:id="mongo.installation.osx">
   <title>Installation sur les systèmes OS X</title>
   
   <para>
    Dans la plupart des cas, l'installation depuis pecl reste le plus simple :
    <programlisting role="shell">
<![CDATA[
$ sudo pecl install mongo
]]>
    </programlisting>
   </para>
   
   <para>
    Si vous utilisez <link xlink:href="&url.mac.homebrew;">Homebrew</link>, 
    PHP tap contient des formules pour le driver. Par exemple, vous pouvez 
    installer le driver pour PHP 5.6 via la commande suivante :
    <programlisting role="shell">
<![CDATA[
$ brew install php56-mongo
]]>
    </programlisting>
   </para>
   <para>
    Si vous utilisez <link xlink:href="&url.xampp;">XAMPP</link>, vous devriez être capable de compiler le driver avec
    la commande suivante :
    <programlisting role="shell">
<![CDATA[
sudo /Applications/XAMPP/xamppfiles/bin/pecl install mongo
]]>
    </programlisting>
   </para>
   <note>
   <title>Dépendance avec Xcode pour compiler sur OS X</title>
   <para>
    Compiler le driver sous OS X requiert les outils de développements Xcode, 
    qui peuvent être installé avec <code>xcode-select --install</code>. Si cette
    commande n'est pas disponible, vous devriez d'abord installer le paquet 
    <link xlink:href="&url.apple.clt;">Command Line Tools</link>.
   </para>
  </note>

  </section>
  
  <section xml:id="mongo.installation.gentoo">
   <title>Gentoo</title>
   <para>
    Gentoo a un paquet pour le driver PHP PECL nommé dev-php/pecl-mongo,
    qui peut installer via la commande suivante :
   </para>
   <programlisting>
<![CDATA[

$ sudo emerge -va dev-php/pecl-mongo

]]>
   </programlisting>
   
   <para>
    Si vous utilisez PECL, vous recevrez une erreur signalant que libtool
    n'est pas à la bonne version. Lors de la compilation depuis les sources,
    vous devriez avoir besoin d'exécuter aclocal et autoconf.
   </para>
   <programlisting role="shell">
<![CDATA[
$ phpize
$ aclocal 
$ autoconf 
$ ./configure
$ make
$ sudo make install
]]>
   </programlisting>
  </section>
  
  <section xml:id="mongo.installation.fedora">
   <title>Red Hat</title>
   <para>
    Ceci inclut Fedora et CentOS.
   </para>
   <para>
    La configuration par défaut d'Apache sur ces systèmes
    ne permet pas aux requêtes d'effectuer des connexions réseaux,
    ceci signifie que le driver recevra une erreur "Permission denied"
    lorsqu'il tentera une connexion à la base de données. Si vous
    rencontrez une telle erreur, tentez d'exécuter ceci :
    <programlisting role="shell">
<![CDATA[
$ /usr/sbin/setsebool -P httpd_can_network_connect 1 
]]>
    </programlisting>
    Puis, redémarrez Apache (Ce comportement peut également survenir
    sous SELinux).
   </para>
  </section>
 </section>
 
 <section xml:id="mongo.installation.thirdparty">
  <title>Instructions d'installation tierces</title>
  
  <para>
   Beaucoup de personnes ont créés d'excellents tutoriels sur l'installation
   du driver PHP.
  </para>
  
  <itemizedlist>
   <listitem>
    <para>
     <link xlink:href="&url.mongodb.install.osx.homebrew;">
      (Re)installer PHP sur Mac OS X
     </link>
    </para>
    <para>
     Cet article de Justin Hileman détaille le processus d’installation de PHP 
     et ses extensions additionnelles avec Homebrew sous OS X. C'est un
     complément pour les instructions de cette page sur l’installation du 
     driver avec Homebrew.
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="&url.mongodb.install.ubuntu.9.10.video;">
      PHP 5.3.1 avec Xdebug, MongoDB et Lithium sous Ubuntu 9.10 / Apache 2.2
     </link>
    </para>
    <para>
     Une excellent vidéo qui vous explique l'installation étape par étape
     d'Apache, PHP, Xdebug, MongoDB, et Lithium par Jon Adams.
    </para>
   </listitem>
  </itemizedlist>
 </section>
 
</section>


<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
