<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 4508b6ad44cfdc54885461e172ec9755a39d1071 Maintainer: yannick Status: ready -->
<!-- Reviewed: no -->

<chapter xml:id="mongo.updates" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Mises à jour</title>

 <para>
  Les mises à jour sont les opérations les plus compliquées disponibles avec
  MongoDB. Elles combinent une requête avec une action, modifiant
  les documents qui correspondent aux critères. Elles sont également
  extrèmement puissantes, vous permettant de changer les documents
  rapidement mais aussi de les remplacer tous ensemble. Elles se font
  sur place (quand c'est possible), entrainant une légère surcharge. 
 </para>

 <section>
  <title>Mises à jour des objets imbriqués</title>
  <para>
   Supposez que vous voulez modifier le nom de l'auteur d'un commentaire dans
   un document :
   <programlisting>
<![CDATA[
{ 
    "_id" : ObjectId("4b06c282edb87a281e09dad9"), 
    "content" : "ceci est un post d'un blog.",
    "comments" : 
    [
        {
            "author" : "Mike",
            "comment" : "Je pense que blah blah blah...",
        },
        {
            "author" : "John",
            "comment" : "Je ne suis pas d'accord."
        }
    ]
}
]]>
   </programlisting>
   Afin de modifie un champ interne, nous utilisez $set (ainsi, les
   autres champs ne sont pas supprimés) avec l'index du commentaire à
   changer :
   <programlisting role="php">
<![CDATA[
<?php

$blog->update($criteria, array('$set' => array("comments.1" => array("author" => "Jim"))));

?>
]]>
   </programlisting>
  </para>
 </section>
</chapter>
