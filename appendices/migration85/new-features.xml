<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: ce397343296708654c8cdac774e23a9ee47ab27d Maintainer: Fan2Shrek Status: ready -->
<!-- Reviewed: yes -->
<sect1 xml:id="migration85.new-features" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Nouvelles fonctionnalités</title>

 <sect2 xml:id="migration85.new-features.core">
  <title>PHP Core</title>

  <sect3 xml:id="migration85.new-features.core.pipe-operator">
   <title>Opérateur pipe</title>

   <simpara>
    Ajout de l'<link linkend="language.operators.functional">opérateur pipe
    (<literal>|&gt;</literal>)</link>.
    <!-- RFC: https://wiki.php.net/rfc/pipe-operator-v3 -->
   </simpara>

   <informalexample>
    <programlisting role="php">
<![CDATA[
<?php
$result = "Hello World" |> strlen(...);
print $result . PHP_EOL;  // Affiche "11"
]]>
    </programlisting>
   </informalexample>
  </sect3>

  <sect3 xml:id="migration85.new-features.core.closures-in-constexpr">
   <title>Fermeture dans les expressions constantes</title>

   <para>
    Ajout du support pour <link linkend="class.closure">Closures</link> et
    <link linkend="functions.first_class_callable_syntax">callables de première classe</link>
    dans les expressions constantes. Cela inclut :

    <simplelist>
     <member>Paramètres d'attribut.</member>
     <member>Valeurs par défaut des propriétés et des paramètres.</member>
     <member>Constantes et constantes de classe.</member>
    </simplelist>

    <!-- RFC: https://wiki.php.net/rfc/closures_in_const_expr -->
    <!-- RFC: https://wiki.php.net/rfc/fcc_in_const_expr -->
   </para>
  </sect3>

  <sect3 xml:id="migration85.new-features.core.nodiscard-attribute">
   <title>L'attribut #[\NoDiscard]</title>

   <simpara>
    Ajout de l'attribut <classname>NoDiscard</classname> pour indiquer que la valeur de retour d'une
    fonction est importante et doit être utilisée.
    <!-- RFC: https://wiki.php.net/rfc/marking_return_value_as_important -->
   </simpara>

   <simpara>
    Par ailleurs, ajout du cast <literal>(void)</literal> pour indiquer que le fait de ne pas utiliser une valeur est intentionnel.
    Le cast <literal>(void)</literal> n'a pas d'effet sur l'exécution du programme en soi, mais
    il peut être utilisé pour supprimer les avertissements émis par <code>#[\NoDiscard]</code> et éventuellement
    aussi les diagnostics émis par des IDE externes ou des outils d'analyse statique.
    <!-- RFC: https://wiki.php.net/rfc/marking_return_value_as_important -->
   </simpara>

   <informalexample>
    <programlisting role="php">
<![CDATA[
<?php

#[\NoDiscard]
function concat(string $a, string $b): string {
     return $a . $b;
}

// Attention : La valeur de retour de la fonction concat() doit être utilisée ou
// intentionnellement ignorée en la castant en (void) dans xxx.php
concat("a", "b");

// Aucun avertissement, car la valeur de retour est utilisée par l'affectation.
$results = concat("a", "b");

// Aucun avertissement, car le cast (void) est utilisé.
(void)concat("a", "b");
]]>
    </programlisting>
   </informalexample>

  </sect3>

  <sect3 xml:id="migration85.new-features.core.attributes-on-constants">
   <title>Attributs sur les constantes</title>

   <simpara>
    Ajout du support des attributs sur les constantes non liées à une classe au moment de la compilation
    (par ex. <code>const MA_CONST = 1;</code> plutôt que
    <code>define('MA_CONST', 1);</code>).
    <!-- RFC: https://wiki.php.net/rfc/attributes-on-constants -->
   </simpara>

   <simpara>
    L'attribut <classname>Deprecated</classname> peut désormais être utilisé sur les constantes.
    <!-- RFC: https://wiki.php.net/rfc/attributes-on-constants -->
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.new-features.core.delayedtargetvalidation-attribute">
   <title>L'attribut <code>#[\DelayedTargetValidation]</code></title>

   <simpara>
    Le nouvel attribut <classname>DelayedTargetValidation</classname> peut être utilisé
    pour supprimer les erreurs de compilation provenant des attributs du core (ou des extensions) qui sont
    utilisés sur des cibles invalides. Ces erreurs sont plutôt signalées à l'exécution si et
    quand <methodname>ReflectionAttribute::newInstance</methodname> est appelé.
    <!-- RFC: https://wiki.php.net/rfc/delayedtargetvalidation_attribute -->
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.new-features.core.override-for-properties">
   <title>L'attribut <code>#[\Override]</code> pour les propriétés</title>

   <simpara>
    L'attribut <classname>Override</classname> peut désormais être appliqué aux propriétés.
    <!-- RFC: https://wiki.php.net/rfc/override_properties -->
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.new-features.core.static-aviz">
   <title>Visibilité asymétrique statique</title>

   <simpara>
    Ajout du support de <link linkend="language.oop5.visibility-members-aviz">visibilité
    asymétrique</link> pour les propriétés statiques.
    <!-- RFC: https://wiki.php.net/rfc/static-aviz -->
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.new-features.core.backtraces-for-fatal-errors">
   <title>Retour de trace pour les erreurs fatales</title>

   <simpara>
    Les erreurs fatales (tels qu'un dépassement du temps d'exécution maximum)
    incluent désormais une trace de retour.
    <!-- RFC: https://wiki.php.net/rfc/error_backtraces_v2 -->
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.new-features.core.final-property-promotion">
   <title>Promotion du constructeur pour les propriétés finales</title>

   <simpara>
    La <link linkend="language.oop5.decon.constructor.promotion">Promotion
    des propriétés du constructeur</link> peut désormais être utilisée pour les propriétés finales.
    <!-- RFC: https://wiki.php.net/rfc/final_promotion -->
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.new-features.core.casts-in-constexpr">
   <title>Cast dans les expressions constantes</title>

   <simpara>
    Ajout du support des casts dans les expressions constantes.
   </simpara>

   <informalexample>
    <programlisting role="php">
<![CDATA[
<?php
const T1 = (int) 0.3; // Avant: "Fatal error: Constant expression contains invalid operations"
print T1 . PHP_EOL;   // Affiche "0"
]]>
    </programlisting>
   </informalexample>

  </sect3>

  <sect3 xml:id="migration85.new-features.core.clone-function">
   <title>Fonction clone</title>

   <simpara>
    La <link linkend="language.oop5.cloning">construction de langage clone</link>
    est désormais une fonction et prend en charge la réaffectation des propriétés (readonly) lors
    du clonage via le nouveau paramètre <property>$withProperties</property>.
    <!-- RFC: https://wiki.php.net/rfc/clone_with_v2 -->
   </simpara>

  </sect3>

 </sect2>

 <sect2 xml:id="migration85.new-features.curl">
  <title>cURL</title>

  <simpara>
   Ajout du support pour 
   <link linkend="class.curlsharepersistenthandle">gestionnaires de partage</link>
   qui sont persistés à travers plusieurs requêtes PHP, permettant en toute sécurité
   une réutilisation plus efficace des connexions.
   <!-- RFC: https://wiki.php.net/rfc/curl_share_persistence_improvement -->
  </simpara>

  <simpara>
   Ajout du support pour <constant>CURLINFO_USED_PROXY</constant> (libcurl >= 8.7.0),
   <constant>CURLINFO_HTTPAUTH_USED</constant>,
   et <constant>CURLINFO_PROXYAUTH_USED</constant> (libcurl >= 8.12.0)
   à la fonction <function>curl_getinfo</function>.
   Lorsque <function>curl_getinfo</function> renvoie un tableau, les mêmes informations
   sont disponibles sous les clés <literal>"used_proxy"</literal>,
   <literal>"httpauth_used"</literal>, et <literal>"proxyauth_used"</literal>.
   <constant>CURLINFO_USED_PROXY</constant> reçoit la valeur zéro si aucun proxy n'a été utilisé lors du
   transfert précédent ou une valeur non nulle si un proxy a été utilisé.
   <constant>CURLINFO_HTTPAUTH_USED</constant> et
   <constant>CURLINFO_PROXYAUTH_USED</constant> reçoivent des masques de bits
   indiquant les méthodes d'authentification HTTP et proxy qui ont été
   utilisées lors de la requête précédente.
   Voir les constantes <constant>CURLAUTH_<replaceable>*</replaceable></constant> pour
   les valeurs possibles.
  </simpara>

  <simpara>
   Ajout de l'option Curl <constant>CURLOPT_INFILESIZE_LARGE</constant>, qui est un remplacement sûr
   pour <constant>CURLOPT_INFILESIZE</constant>. Sur certains systèmes,
   <constant>CURLOPT_INFILESIZE</constant> n'accepte qu'un entier signé 32 bits comme
   taille de fichier (2,0 Gio) même sur les systèmes 64 bits.
   <constant>CURLOPT_INFILESIZE_LARGE</constant> accepte la plus grande valeur entière
   que le système peut gérer.
  </simpara>

  <simpara>
   Ajout des valeurs <constant>CURLFOLLOW_OBEYCODE</constant>,
   <constant>CURLFOLLOW_FIRSTONLY</constant> et <constant>CURLFOLLOW_ALL</constant>
   pour l'option <constant>CURLOPT_FOLLOWLOCATION</constant>
   de la fonction <function>curl_setopt</function>.
   <constant>CURLFOLLOW_OBEYCODE</constant> pour suivre plus strictement en ce qui concerne
   les redirections si elles sont autorisées.
   <constant>CURLFOLLOW_FIRSTONLY</constant> pour ne suivre que la première redirection, ainsi
   si une redirection de suivi existe, elle ne sera pas suivie davantage.
   <constant>CURLFOLLOW_ALL</constant> est équivalent à définir
   <constant>CURLOPT_FOLLOWLOCATION</constant> sur true.
  </simpara>

  <simpara>
   Ajout du support pour <constant>CURLINFO_CONN_ID</constant> (libcurl >= 8.2.0)
   à la fonction <function>curl_getinfo</function>. Cette constante permet de récupérer
   l'ID unique de la connexion utilisée par un transfert cURL. Elle est principalement
   utile lorsque la réutilisation de connexion ou la logique de pool de connexions est nécessaire dans
   les applications au niveau PHP. Lorsque <function>curl_getinfo</function> renvoie un tableau,
   cette valeur est disponible sous la clé <literal>"conn_id"</literal>.
  </simpara>

  <simpara>
   Ajout du support pour <constant>CURLINFO_QUEUE_TIME_T</constant> (libcurl >= 8.6.0)
   à la fonction <function>curl_getinfo</function>. Cette constante permet de récupérer
   le temps (en microsecondes) que la requête a passé dans la file d'attente de connexion
   de libcurl avant d'être envoyée.
   Cette valeur peut également être récupérée en passant
   <constant>CURLINFO_QUEUE_TIME_T</constant> au paramètre <parameter>option</parameter>
   de <function>curl_getinfo</function>.
  </simpara>

  <simpara>
   Ajout du support pour <constant>CURLOPT_SSL_SIGNATURE_ALGORITHMS</constant> 
   pour spécifier les algorithmes de signature à utiliser pour TLS.
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.dom">
  <title>DOM</title>

  <simpara>
   Ajout de <property>Dom\Element::$outerHTML</property>.
  </simpara>

  <simpara>
   Ajout de la propriété <property>$children</property> aux
   implémentations de <interfacename>Dom\ParentNode</interfacename>.
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.exif">
  <title>EXIF</title>

  <simpara>
   Ajout du support pour les tags Exif <literal>OffsetTime*</literal>.
  </simpara>

  <simpara>
   Ajout du support pour HEIF/HEIC.
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.filter">
  <title>Filter</title>

  <simpara>
   Ajout du nouveau drapeau <constant>FILTER_THROW_ON_FAILURE</constant> qui peut être
   passé aux fonctions de filtrage et qui forcera le déclenchement d'une exception
   lorsque la validation échoue.
   Le nouveau drapeau ne peut pas être combiné avec
   <constant>FILTER_NULL_ON_FAILURE</constant>; essayer de le faire entraînera
   une <exceptionname>ValueError</exceptionname> levée.
   <!-- RFC: https://wiki.php.net/rfc/filter_throw_on_failure -->
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.intl">
  <title>Intl</title>

  <simpara>
   Ajout des constantes de classes <constant>NumberFormatter::CURRENCY_ISO</constant>,
   <constant>NumberFormatter::CURRENCY_PLURAL</constant>,
   <constant>NumberFormatter::CASH_CURRENCY</constant>,
   et <constant>NumberFormatter::CURRENCY_STANDARD</constant>
   pour divers styles de formatage des devises.
  </simpara>

  <simpara>
   Ajout de <methodname>Locale::addLikelySubtags</methodname> et
   <methodname>Locale::minimizeSubtags</methodname> pour gérer les tags probables
   sur une locale donnée.
  </simpara>

  <simpara>
   Ajout de la classe <classname>IntlListFormatter</classname> pour formater, ordonner,
   et ponctuer une liste d'éléments avec une locale donnée, les opérandes
   <constant>IntlListFormatter::TYPE_AND</constant>,
   <constant>IntlListFormatter::TYPE_OR</constant>,
   <constant>IntlListFormatter::TYPE_UNITS</constant> et les longueurs
   <constant>IntlListFormatter::WIDTH_WIDE</constant>,
   <constant>IntlListFormatter::WIDTH_SHORT</constant> et
   <constant>IntlListFormatter::WIDTH_NARROW</constant>.
   Il est supporté à partir de icu 67.
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.pdo-sqlite">
  <title>PDO_Sqlite</title>

  <simpara>
   Ajout de la constante de classe <constant>Pdo\Sqlite::ATTR_BUSY_STATEMENT</constant>.
  </simpara>

  <simpara>
   Ajout des constantes de classes <constant>Pdo\Sqlite::ATTR_EXPLAIN_STATEMENT</constant>,
   <constant>Pdo\Sqlite::EXPLAIN_MODE_PREPARED</constant>,
   <constant>Pdo\Sqlite::EXPLAIN_MODE_EXPLAIN</constant>,
   <constant>Pdo\Sqlite::EXPLAIN_MODE_EXPLAIN_QUERY_PLAN</constant>.
  </simpara>

  <simpara>
   Ajout de l'attribut de connexion <constant>Pdo\Sqlite::ATTR_TRANSACTION_MODE</constant>
   avec les valeurs possibles <constant>Pdo\Sqlite::TRANSACTION_MODE_DEFERRED</constant>,
   <constant>Pdo\Sqlite::TRANSACTION_MODE_IMMEDIATE</constant>,
   et <constant>Pdo\Sqlite::TRANSACTION_MODE_EXCLUSIVE</constant>,
   permettant de configurer le mode de transaction à utiliser lors de l'appel de beginTransaction().
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.session">
  <title>Session</title>

  <simpara>
   <function>session_set_cookie_params</function>,
   <function>session_get_cookie_params</function>,
   et <function>session_start</function> supportent désormais les cookies partitionnés
   avec la clé <literal>"partitioned"</literal>.
   <!-- RFC: https://wiki.php.net/rfc/CHIPS -->
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.soap">
  <title>SOAP</title>

  <simpara>
   Les cas d'énumération sont désormais inclus dans <methodname>SoapClient::__getTypes</methodname>.
  </simpara>

  <simpara>
   Ajout du support de l'attribut xml:lang du texte Reason de Soap 1.2.
  </simpara>

  <simpara>
   La signature de <methodname>SoapFault::__construct</methodname> et
   <methodname>SoapServer::fault</methodname> inclut désormais un paramètre
   optionnel <parameter>$lang</parameter>.
   Ceci résout la compatibilité avec les clients SOAP .NET.
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.standard">
  <title>Standard</title>

  <simpara>
   <function>mail</function> renvoie désormais l'erreur réelle de sendmail et détecte
   si le processus sendmail a été terminé de manière inattendue.
   Dans de tels cas, un avertissement est émis et la fonction renvoie false.
   Auparavant, ces erreurs étaient silencieusement ignorées.
   Ce changement n'affecte que le transport sendmail.
  </simpara>

  <simpara>
   <function>getimagesize</function> supporte désormais les images HEIF/HEIC.
  </simpara>

  <simpara>
   <function>getimagesize</function> supporte désormais les images SVG lorsque l'extension ext-libxml
   est également chargée.
   De même, <function>image_type_to_extension</function> et
   <function>image_type_to_mime_type</function>
   gèrent désormais également IMAGETYPE_SVG.
  </simpara>

  <simpara>
   Le tableau renvoyé par <function>getimagesize</function> contient désormais deux entrées supplémentaires :
   <literal>"width_unit"</literal> et <literal>"height_unit"</literal> pour indiquer dans
   quelles unités les dimensions sont exprimées. Ces unités sont px par défaut. Elles ne sont pas
   nécessairement les mêmes (juste pour donner un exemple : l'une peut être en cm et l'autre en px).
  </simpara>

  <simpara>
   <function>setcookie</function> et <function>setrawcookie</function> supportent désormais la
   clé <literal>"partitioned"</literal>.
   <!-- RFC: https://wiki.php.net/rfc/CHIPS -->
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.uri">
  <title>URI</title>

  <simpara>
   Une extension uri toujours activée a été ajoutée et peut être utilisée pour gérer
   les URI et les URL conformément à la RFC 3986 et à WHATWG URL.
   <!-- RFC: https://wiki.php.net/rfc/url_parsing_api -->
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.xsl">
  <title>XSL</title>

  <simpara>
   L'argument <parameter>$namespace</parameter> de <methodname>XSLTProcessor::getParameter</methodname>,
   <methodname>XSLTProcessor::setParameter</methodname> et
   <methodname>XSLTProcessor::removeParameter</methodname> fonctionne désormais réellement
   au lieu d'être traité comme vide.
   Cela ne fonctionne que si l'argument <parameter>$name</parameter> n'utilise pas la notation Clark et n'est pas un
   QName car dans ces cas, l'espace de noms est pris à partir de l'href ou du préfixe de l'espace
   de noms respectivement.
  </simpara>

 </sect2>

 <sect2 xml:id="migration85.new-features.zlib">
  <title>Zlib</title>

  <simpara>
   <function>flock</function> est désormais pris en charge sur les flux zlib. Auparavant,
   cela échouait toujours à effectuer toute action de verrouillage.
  </simpara>

 </sect2>

</sect1>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
