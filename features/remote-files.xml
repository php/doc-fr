<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: a0ae28d3bc85f927c22649ebd9a590b921534b7d Maintainer: lacatoire Status: ready -->
<!-- Reviewed: yes -->

<chapter xml:id="features.remote-files" xmlns="http://docbook.org/ns/docbook">
 <title>Utilisation des fichiers à distance</title>
 <para>
  Aussi longtemps que le support des gestionnaires d'URL ("URL fopen wrapper")
  est activé dans le &php.ini;, avec l'option <option>allow_url_fopen</option>,
  il est possible d'utiliser des URL (<acronym>HTTP</acronym> et <acronym>FTP</acronym>)
  avec la majorité des fonctions qui utilisent un
  nom de fichier comme paramètre. Cela inclut notamment
  <function>include</function>,
  <function>include_once</function>,
  <function>require</function> et
  <function>require_once</function>
  (<option>allow_url_include</option> doit être actif pour les utiliser).
  Se reporter à <xref linkend="wrappers"/> pour plus d'informations
  sur les protocoles supportés par PHP.
 </para>
 <para>
  Par exemple, il est possible de suivre l'exemple suivant pour ouvrir un
  fichier sur un serveur web distant, analyser les résultats
  pour extraire les informations nécessaires, et ensuite
  les utiliser dans une requête de base de données, ou
  simplement éditer les informations dans le style du site.
 </para>
 <para>
  <example>
   <title>Connaître le titre d'une page distante</title>
   <programlisting role="php">
<![CDATA[
<?php
$file = fopen ("http://www.example.com/", "r");
if (!$file) {
  echo "<p>Impossible de lire la page.\n";
  exit;
}
while (!feof ($file)) {
    $line = fgets ($file, 1024);
    /* Cela ne fonctionne que si le titre et ses balises sont sur une seule ligne */
    if (preg_match ("@\<title\>(.*)\</title\>@i", $line, $out)) {
        $title = $out[1];
        break;
    }
}
fclose($file);
?>
]]>
   </programlisting>
  </example>
 </para>
 <para>
  Il est aussi possible d'écrire des fichiers sur un serveur FTP
  (à condition d'être connecté en tant qu'utilisateur ayant les bons
  droits d'accès). Seuls de nouveaux fichiers peuvent être créés avec
  cette méthode ; toute tentative d'écraser un fichier existant fera que
  l'appel à <function>fopen</function> échouera.
 </para>
 <para>
  Pour se connecter avec un utilisateur autre qu'anonyme, il faut
  spécifier un nom d'utilisateur (et certainement le mot de passe) dans
  l'URL, comme <literal>ftp://user:password@ftp.example.com/path/to/file</literal>.
  (Il est possible d'utiliser le même type de syntaxe pour accéder
  aux fichiers via <acronym>HTTP</acronym> lorsqu'ils nécessitent une
  identification simple).
 </para>
 <para>
  <example>
   <title>Stocker des données sur un serveur distant</title>
   <programlisting role="php">
<![CDATA[
<?php
$file = fopen ("ftp://ftp.example.com/incoming/outputfile", "w");
if (!$file) {
  echo "<p>Impossible d'ouvrir le fichier distant pour écriture.\n";
  exit;
}
/* Ecriture des données. */
fwrite ($file, $_SERVER['HTTP_USER_AGENT'] . "\n");
fclose ($file);
?>
]]>
   </programlisting>
  </example>
 </para>
 <para>
  <note>
   <para>
    On pourrait avoir l'idée, à partir de
    l'exemple ci-dessus, d'utiliser la même technique pour
    écrire dans un fichier de log distant. Malheureusement
    cela ne fonctionnerait pas car l'appel à <function>fopen</function>
    échouera si le fichier distant existe déjà. Pour faire de la
    journalisation distribuée, il est recommandé de plutôt regarder du côté de
    <function>syslog</function>.
   </para>
  </note>
 </para>
</chapter>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
