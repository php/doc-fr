<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.7 $ -->
<!-- EN-Revision: 1.1 Maintainer: nobody Status: partial -->
  <sect1 id="install.netscape-enterprise">
 <title>Installation sous Netscape et iPlanet Enterprise Serveur</title>
 <para>
  Cette section contient les notes et détails spécifiques à l'installation
  Netscape et iPlanet, aussi bien pour <link linkend="install.netscape.sun">Sun Solaris</link>
  que <link linkend="install.netscape.windows">Windows</link>.
 </para>
 <para>
  Vous pouvez trouvez plus d'informations sur la configuration de
  PHP avec Netscape Enterprise Server :
  <ulink url="&url.netscape.nsapi;">&url.netscape.nsapi;</ulink>
 </para>
 <sect2 id="install.netscape.sun">
  <title>Installer PHP avec Netscape sous Sun Solaris</title>
  <para>
   Pour compiler PHP avec NES ou iPlanet, indiquez le bon dossier
   d'installation pour l'option de configuration
   <link linkend="install.configure.with-nsapi">--with-nsapi</link>
   = <replaceable>DIR</replaceable> option. Le dossier par défaut
   est généralement <filename class="directory">/opt/netscape/suitespot/</filename>.
   Lisez aussi <filename>/php-xxx-version/sapi/nsapi/nsapi-readme.txt</filename>.
  </para>
    <note>
     <simpara>
      Ces instructions, valables pour Sun Solaris 2.6 avec Netscape
      Enterprise Server 3.6, sont l'oeuvre de bhager at invacare dot com.
     </simpara>
    </note>
    <para>
     <orderedlist>
      <listitem>
       <para>
        Installez les packages suivants depuis le serveur 
<ulink url="&url.sun.freeware;">&url.sun.freeware;</ulink> 
ou un miroir ad hoc :
        <simplelist>
         <member><filename>autoconf-2.13</filename></member>
         <member><filename>automake-1.4</filename></member>
         <member><filename>bison-1_25-sol26-sparc-local</filename></member>
         <member><filename>flex-2_5_4a-sol26-sparc-local</filename></member>
         <member><filename>gcc-2_95_2-sol26-sparc-local</filename></member>
         <member><filename>gzip-1.2.4-sol26-sparc-local</filename></member>
         <member><filename>m4-1_4-sol26-sparc-local</filename></member>
         <member><filename>make-3_76_1-sol26-sparc-local</filename></member>
         <member>
          <filename>mysql-3.23.24-beta</filename> (si vous voulez le support MySQL)
         </member>
         <member><filename>perl-5_005_03-sol26-sparc-local</filename></member>
         <member><filename>tar-1.13</filename> (GNU tar)</member>
        </simplelist>
       </para>
      </listitem>
      <listitem>
       <simpara>
        Assurez-vous que le path inclut bien les dossiers nécessaires :
        <literal>PATH=.:/usr/local/bin:/usr/sbin:/usr/bin:/usr/ccs/bin</literal>
        et rendez le accessible à vortre système avec <userinput>export PATH</userinput>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        <userinput>gunzip php-x.x.x.tar.gz</userinput> 
        (si vous avez une distribution .gz, ou bien allez en 4).
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        <userinput>tar xvf php-x.x.x.tar</userinput>
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Passez dans votre dossier PHP : 
        <userinput>cd ../php-x.x.x </userinput>
       </simpara>
      </listitem>
      <listitem>
       <para>
Pour les étapes suivantes, assurez-vous que <filename class="directory">/opt/netscape/suitespot/</filename>
correspond bien à votre installation du serveur netscape. Sinon, indiquez le chemin
correct :
        <programlisting role="shell">
<![CDATA[
./configure --with-mysql=/usr/local/mysql \
--with-nsapi=/opt/netscape/suitespot/ \
--enable-libgcc
]]>
        </programlisting>
       </para>
      </listitem>
      <listitem>
       <simpara>
        Faites un <command>make</command> puis un <command>make install</command>.
       </simpara>
      </listitem>
     </orderedlist>
    </para>
    <para>
  Après avoir fait l'installation de base et lu les fichiers
  readme.txt, vous pouvez avoir besoin de faire des configurations
  supplémentaires.
 </para>
 <para>
  D'abord, vous devez ajouter des chemins dans la variable
  LD_LIBRARY_PATH pour que PHP trouve toutes les librairies
  partagées. Le mieux est de le faire dans le script de
  démarrage de votre serveur Netscape. Les utilisateurs Windows
  peuvent probablement ignorer cette étape. Le script de
  démarrage est situé dans :
  <filename
  class="directory">/path/to/server/https-servername/start</filename>
 </para>
 <para>
  Vous pouvez aussi avoir besoin d'éditer les fichiers de
  configuration qui sont situés dans : <filename
  class="directory">/path/to/server/https-servername/config/</filename>.
 </para>
    <formalpara>
     <title>Instructions de configuration pour Netscape Entreprise Server</title>
     <para>
      Tout d'abord, vous aurez besoin d'ajouter des chemins dans la variable
      <varname>LD_LIBRARY_PATH</varname> pour que Netscape trouve son bonheur.
      Il est préférable de le faire dans le script de démarrage du serveur
      Netscape. Les utilisateurs Windows peuvent ignorer cette étape. Le script
      de démarrage est souvent situé dans : 
      <filename class="directory">/path/to/server/https-servername/start</filename>.
      Vous aurez peut être à éditer le fichier de configuration situé dans 
      <filename class="directory">/path/to/server/https-servername/config/</filename>.
      <orderedlist>
       <listitem>
        <para>
         Ajoutez les lignes suivantes dans <filename>mime.types</filename>:
         <screen>
<![CDATA[
type=magnus-internal/x-httpd-php exts=php
]]>
         </screen>
        </para>
       </listitem>
       <listitem>
        <para>
         Ajoutez les lignes suivantes dans <filename>obj.conf</filename>.
         shlib peut varier en fonction de votre OS. Pour Unix, c'est
         quelquechose comme <filename>/opt/netscape/suitespot/bin/libphp4.so</filename>.
         Il est conseillé de placer les lignes suivantes après les
	    lignes de <literal>mime types init</literal>.
         <programlisting>
<![CDATA[
Init fn="load-modules" funcs="php4_init,php4_close,php4_execute,php4_auth_trans" shlib="/php4/nsapiPHP4.dll"
Init fn=php4_init errorString="Failed to initialize PHP!"
]]>
         </programlisting>
        </para>
       </listitem>
       <listitem>
        <para>
         Configurez les valeurs par défaut : 
         <programlisting>
<![CDATA[
<object name="default">
.
.
.
.#NOTE this next line should happen after all 'ObjectType' and before all 'AddLog' lines 
Service fn="php4_execute" type="magnus-internal/x-httpd-php" 
    . 
    . 
    </Object>
]]>
         </programlisting>
        </para>
       </listitem>
       <listitem>
        <para>
         Créez un nouvel objet pour &php; :
         <programlisting>
<![CDATA[
<Object name="x-httpd-php"> 
ObjectType fn="force-type" type="magnus-internal/x-httpd-php" 
Service fn=php4_execute 
</Object> 
]]>
         </programlisting>
        </para>
       </listitem>
       <listitem>
        <para>
         Configuration d'authentification
    L'authentification PHP ne peut pas être utilisée avec
    d'autres authentifications.
    TOUTES LES FORMES D'AUTHENTIFICATION SONT PASSEES AU SCRIPT PHP.
    Pour configurer l'authentification PHP pour le serveur entier, ajoutez
    la ligne suivante :
         <programlisting>
<![CDATA[
<Object name="default">
AuthTrans fn=php4_auth_trans
.
.
.
</Object>
]]>
         </programlisting>
        </para>
       </listitem>
       <listitem>
        <para>
         Pour utiliser l'identification &php; sur un seul dossier, utilisez 
         la ligne suivante : 
         <programlisting>
<![CDATA[
<Object ppath="d:\path\to\authenticated\dir\*"> 
AuthTrans fn=php4_auth_trans 
</Object>
]]>
         </programlisting>
        </para>
       </listitem>
      </orderedlist>
     </para>
    </formalpara>
    <para>
    Si vous utilisez Netscape Enterprise 4.x, alors, il faut utiliser ceci :
     placez ces lignes dans les informations d'initialisation des 
     types Mime, et tout ce qui y est rattaché dans la configuration
     ci-dessus : (fourni par Graeme Hoose, GraemeHoose at BrightStation dot com).
     <programlisting>
<![CDATA[
Init fn="load-modules" shlib="/path/to/server4/bin/libphp4.so" funcs="php4_init,php4_close,php4_execute,php4_auth_trans"
Init fn="php4_init" LateInit="yes"
]]>
     </programlisting>
    </para>
   </sect2>
   <sect2 id="install.netscape.windows">
  <title>Installer PHP avec Netscape Enterprise sous Windows</title>
  <para>
    Pour installer PHP sous forme de CGI (pour Netscape Enterprise Server,
    iPlanet, peut être Fastrack), suivez ces instructions :
  </para>
  <itemizedlist>
   <listitem>
    <simpara>
     Copiez le fichier <filename>php4ts.dll</filename> dans votre dossier
     systemroot (le dossier où vous avez installé windows)
    </simpara>
   </listitem>
   <listitem>
    <para>
     Faîtes un fichier d'association depuis la ligne de commande.
     Tapez les lignes suivantes :
       <programlisting>
<![CDATA[
assoc .php=PHPScript
ftype PHPScript=c:\php\php.exe %1 %*
]]>
       </programlisting>
     </para>
   </listitem>
   <listitem>
    <simpara>
     Dans le serveur Netscape Enterprise Administration Server,
     créez un dossier shellcgi et supprimez-le aussitôt (cette
     opération crée 5 lignes importantes dans le fichier
     obj.conf et permet au serveur de gérer les scripts CGI).
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Dans le serveur Netscape Enterprise Administration Server, créez un
     nouveau type MIME (Category: type,
     Content-Type: magnus-internal/shellcgi, File Suffix:php).
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Recommencez pour chaque instance de serveur web qui devra exécuter
     PHP.
    </simpara>
   </listitem>
  </itemizedlist>
  <para>
   Plus de détails sur la configuration de PHP comme CGI sont
   disponibles à <ulink url="&url.netscape.cgi;">&url.netscape.cgi;</ulink>
  </para>
  <para>
   Pour installer PHP avec l'interface NSAPI (pour Netscape Enterprise Server,
   iPlanet, peut-être Fastrack), faîtes ceci :
  </para>
  <itemizedlist>
   <listitem>
    <simpara>
     Copiez le fichier <filename>php4ts.dll</filename> dans votre dossier
     systemroot (le dossier où vous avez installé windows)
    </simpara>
   </listitem>
   <listitem>
    <para>
     Faîtes un fichier d'association depuis la ligne de commande.
     Tapez les lignes suivantes :
       <programlisting>
<![CDATA[
assoc .php=PHPScript
ftype PHPScript=c:\php\php.exe %1 %*
]]>
       </programlisting>
    </para>
   </listitem>
   <listitem>
    <simpara>
     Dans le serveur Netscape Enterprise Administration Server, créez un
     nouveau type MIME (Category: type,
     Content-Type: magnus-internal/shellcgi, File Suffix:php).
    </simpara>
   </listitem>
   <listitem>
    <para>
     Stoppez votre serveur web et éditez le fichier <filename>obj.conf</filename>.
     A la fin de la section Init, placez ces deux lignes (obligatoirement
     après l'init de type MIME) :
       <programlisting>
<![CDATA[
Init fn="load-modules" funcs="php4_init,php4_close,php4_execute,php4_auth_trans" shlib="c:/php/sapi/php4nsapi.dll"
Init fn="php4_init" errorString="Failed to initialise PHP!"
]]>
       </programlisting>
      </para>
   </listitem>
   <listitem>
    <para>
     Dans la section <literal>&lt; Object name="default" &gt;</literal>,
     placez cette ligne, obligatoirement après toutes les lignes
     'ObjectType' et avant les lignes 'AddLog' :
       <programlisting>
<![CDATA[
Service fn="php4_execute" type="magnus-internal/x-httpd-php"
]]>
       </programlisting>
   </para>
   </listitem>
   <listitem>
    <para>
     A la fin du fichier, créez un nouvel objet appelé
     <literal>x-httpd-php</literal>, en insérant ces lignes :
       <programlisting>
<![CDATA[
<Object name="x-httpd-php">
ObjectType fn="force-type" type="magnus-internal/x-httpd-php"
Service fn=php4_execute
</Object>
]]>
     </programlisting>
    </para>
   </listitem>
   <listitem>
    <simpara>
     Redémarrez votre serveur web, et validez les modifications
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Recommencez pour chaque serveur qui doit utiliser PHP.
    </simpara>
   </listitem>
  </itemizedlist>
  <para>
   Plus de détails sur la configiration de PHP en
   filtre NSAPI sont disponibles :
   <ulink url="&url.netscape.nsapi;">&url.netscape.nsapi;</ulink>
  </para>
 </sect2>
   <sect2 id="install.netscape.specialpages">
    <title>Utilisation particulière pour les pages d'erreurs ou les 
    listages spécifiques de dossier (PHP &gt;= 4.3.3)</title>
    <para>
     Vous pouvez utilise PHP pour générer des pages d'erreurs de type
     <literal>"404 Not Found"</literal> ou apparantée. Ajoutez la ligne
     suivante dans le fichier <filename>obj.conf</filename> pour chaque
     page d'erreur que vous souhaitez remplacer : 
     <programlisting>
<![CDATA[
Error fn="php4_execute" code=XXX script="/path/to/script.php" [inikey=value inikey=value...]
]]>
     </programlisting>
     où <literal>XXX</literal> est le code d'erreur HTTP. Effacez tout autre
     directive <literal>Error</literal> qui pourrait interférer avec la votre.
     Si vous voulez utiliser une page pour toutes les erreurs qui existent,
     laissez le paramètre <literal>code</literal> vide. Votre script peut 
     obtenir le code de statut HTTP dans la variable 
     <literal>$_SERVER['ERROR_TYPE']</literal>.
    </para>
    <para>
     Une autre possibilité est de générer une liste de dossier personnalisée.
     Créez simplement un script PHP qui affiche la liste du dossier, et 
     remplacez la ligne <literal>Service</literal> par défaut par
     <literal>type=&quot;magnus-internal/directory&quot;</literal> 
     dans <filename>obj.conf</filename> avec ceci :
     <programlisting>
<![CDATA[
Service fn="php4_execute" type="magnus-internal/directory" script="/path/to/script.php" [inikey=value inikey=value...]
]]>
     </programlisting>
     Pour ces deux points, l'URI originale et l'URI traduite sont
     dans les variables <literal>$_SERVER['PATH_INFO']</literal> et
     <literal>$_SERVER['PATH_TRANSLATED']</literal>.
    </para>
   </sect2>
   <sect2 id="install.netscape.notes">
    <title>
     Note au sujet de <function>nsapi_virtual</function> et des requêtes (PHP &gt;= 4.3.3)
    </title>
    <para>
     Le module NSAPI supporte désormais la fonction <function>nsapi_virtual</function>
     (alias : <function>virtual</function>), pour réaliser des sous requêtes au serveur
     web, et inclure le résultat dans une page. Le problème est que cette fonction
     utilise une fonctionnalité non documentée de la librairie
     NSAPI.
    </para>
    <para>
     Sous Unix, ce n'est pas un problème, car le module va automatiquement
     rechercher les fonctions nécessaires, et les utiliser si elles sont
     disponibles. Sinon, <function>nsapi_virtual</function> sera désactivée.
    </para>
    <para>
     Sous Windows, des limitations dans la gestion des DLL impose l'utilisation
     de la plus récente librairie <filename>ns-httpdXX.dll</filename>. Cela a été
     testé pour les serveurs jusqu'à la version 6.0. Si une nouvelle version de
     SunONE server est utilisée, la détection échoue, et 
     <function>nsapi_virtual</function> est désactivée.
    </para>
    <para>
     Dans ce cas, essayez ceci : 
     ajoutez le paramètre suivant à <literal>php4_init</literal> dans
     <filename>magnus.conf</filename>/<filename>obj.conf</filename>:
     <programlisting>
<![CDATA[
Init fn=php4_init ... server_lib="ns-httpdXX.dll"
]]>
     </programlisting>
     où <literal>XX</literal> est le numéro correct de la version de la DLL.
     Pour la connaître, regardez dans le <literal>server-root</literal>
     pour connaitre le nom correct de la DLL. La DLL la plus grande en taille
     est la bonne.
    </para>
    <para>
     Vous pouvez vérifier le status en utilisant la fonction <function>phpinfo</function>.
    </para>
    <note>
     <para>
      Soyez prévenu : le support de <function>nsapi_virtual</function> est expérimental.
     </para>
    </note>
   </sect2>   
</sect1>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
